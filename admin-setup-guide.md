# 后台管理系统部署指南

## 概述
已经成功开发完成旅行规划系统的后台管理系统，包含完整的管理员功能。

## 主要功能

### 1. 管理员登录
- 管理员专属登录页面：`/admin`
- 基于角色的权限验证
- 管理员账户需要管理员权限（role = 'admin'）

### 2. 管理功能模块

#### 仪表板 (`/admin/dashboard`)
- 系统概览统计
- 快速操作入口
- 最近活动记录

#### 用户管理 (`/admin/users`)
- 查看所有用户列表
- 添加新用户
- 编辑用户信息
- 删除用户（不能删除当前登录的管理员）
- 用户角色管理（普通用户/管理员）

#### 景点管理 (`/admin/attractions`)
- 查看所有景点
- 添加新景点
- 编辑景点信息
- 删除景点
- 景点搜索和筛选

## 技术架构

### 前端技术栈
- Vue.js 3 + Composition API
- Ant Design Vue 组件库
- Vue Router 路由管理

### 权限控制
- 基于角色的访问控制（RBAC）
- 路由守卫实现权限验证
- 管理员权限检查

### 数据服务
- 独立的 `adminService` 服务层
- Supabase REST API 集成
- 错误处理和用户反馈

## 部署步骤

### 1. 数据库准备
确保数据库中已添加管理员角色支持：

```sql
-- 添加管理员角色字段到用户表
ALTER TABLE app_users ADD COLUMN IF NOT EXISTS role VARCHAR(20) DEFAULT 'user';

-- 创建管理员账户（示例）
UPDATE app_users SET role = 'admin' WHERE username = 'admin';
```

### 2. 管理员账户创建

#### 方式一：通过现有用户升级
```sql
-- 将现有用户升级为管理员
UPDATE app_users SET role = 'admin' WHERE username = '管理员用户名';
```

#### 方式二：创建新的管理员账户
需要创建新的用户账户，然后将其角色设置为 'admin'。

### 3. 环境配置
确保以下环境变量已正确配置：
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 4. 启动应用
```bash
cd web-app
npm install
npm run dev
```

## 访问方式

### 前台用户访问
- 首页：`http://localhost:5173/`
- 普通用户功能正常使用

### 后台管理访问
- 管理员登录：`http://localhost:5173/admin`
- 使用管理员账户登录
- 登录后自动跳转到仪表板

## 安全特性

### 权限验证
- 所有后台路由都有 `requiresAdmin` 元信息
- 非管理员用户无法访问后台页面
- 未登录用户会被重定向到首页

### 数据保护
- 管理员不能删除自己的账户
- 敏感操作需要确认
- 所有 API 调用都有权限检查

## 测试建议

### 功能测试
1. 使用普通用户账户尝试访问后台页面（应被拒绝）
2. 使用管理员账户登录后台
3. 测试用户管理功能
4. 测试景点管理功能
5. 验证权限控制是否正常工作

### 边界测试
1. 尝试删除当前登录的管理员账户
2. 测试空数据情况
3. 验证搜索和筛选功能

## 常见问题

### Q: 无法访问后台页面
A: 检查当前登录用户是否为管理员（role = 'admin'）

### Q: API 调用失败
A: 检查 Supabase 配置和环境变量

### Q: 用户管理功能异常
A: 确认数据库中的用户表结构是否正确

## 后续扩展

### 建议的功能扩展
1. 操作日志记录
2. 系统设置管理
3. 数据备份和恢复
4. 批量操作功能
5. 高级搜索和筛选

### 性能优化
1. 数据分页加载
2. 图片上传优化
3. 缓存策略实现

---

**注意**：请确保在生产环境中使用强密码，并定期更换管理员账户密码。