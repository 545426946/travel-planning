# ğŸ—„ï¸ Supabase æ•°æ®åº“é›†æˆè¯´æ˜

## ğŸ“‹ é›†æˆæ¦‚è§ˆ

é¡¹ç›®å·²æˆåŠŸè¿æ¥åˆ° Supabase æ•°æ®åº“ `travel-planning2.0`ï¼Œå®ç°äº†æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨å’Œç®¡ç†ã€‚

## ğŸ”— æ•°æ®åº“è¿æ¥ä¿¡æ¯

- **URL**: `https://hmnjuntvubqvbpeyqoxw.supabase.co`
- **é¡¹ç›®åç§°**: travel-planning2.0
- **åŒ¿åå¯†é’¥**: å·²é…ç½®åœ¨ `.env` æ–‡ä»¶ä¸­

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### 1. users (ç”¨æˆ·è¡¨)
- `id` - ç”¨æˆ·å”¯ä¸€æ ‡è¯† (UUID)
- `openid` - å¾®ä¿¡ç”¨æˆ·å”¯ä¸€æ ‡è¯†
- `name` - ç”¨æˆ·å§“å
- `avatar` - å¤´åƒURL
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

### 2. destinations (æ™¯ç‚¹è¡¨)
- `id` - æ™¯ç‚¹å”¯ä¸€æ ‡è¯† (UUID)
- `name` - æ™¯ç‚¹åç§°
- `description` - æ™¯ç‚¹æè¿°
- `image_url` - æ™¯ç‚¹å›¾ç‰‡URL
- `rating` - è¯„åˆ† (0.00-5.00)
- `location` - åœ°ç†ä½ç½®
- `category` - æ™¯ç‚¹åˆ†ç±»
- `is_featured` - æ˜¯å¦ä¸ºæ¨èæ™¯ç‚¹
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

### 3. travel_plans (è¡Œç¨‹è¡¨)
- `id` - è¡Œç¨‹å”¯ä¸€æ ‡è¯† (UUID)
- `user_id` - ç”¨æˆ·ID (å¤–é”®)
- `title` - è¡Œç¨‹æ ‡é¢˜
- `description` - è¡Œç¨‹æè¿°
- `destination` - ç›®çš„åœ°
- `start_date` - å¼€å§‹æ—¥æœŸ
- `end_date` - ç»“æŸæ—¥æœŸ
- `budget` - é¢„ç®—
- `travel_type` - æ—…è¡Œç±»å‹
- `status` - çŠ¶æ€
- `is_ai_generated` - æ˜¯å¦AIç”Ÿæˆ
- `tags` - æ ‡ç­¾æ•°ç»„
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

### 4. å…¶ä»–è¡¨
- `profiles` - ç”¨æˆ·æ¡£æ¡ˆ
- `plan_activities` - è¡Œç¨‹æ´»åŠ¨
- `plan_templates` - è¡Œç¨‹æ¨¡æ¿
- `travel_templates` - æ—…è¡Œæ¨¡æ¿
- `app_users` - åº”ç”¨ç”¨æˆ·
- `user_sessions` - ç”¨æˆ·ä¼šè¯

## ğŸ“¦ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
æ—…è¡Œè§„åˆ’è½»é‡åŒ–é¡¹ç›®/
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ supabase.js        # Supabase å®¢æˆ·ç«¯é…ç½®
â”‚   â””â”€â”€ database.js        # æ•°æ®åº“æ“ä½œå°è£…
â”œâ”€â”€ app.js                 # å°ç¨‹åºå…¥å£ (å·²æ›´æ–°)
â”œâ”€â”€ index/
â”‚   â””â”€â”€ index.js          # é¡µé¢é€»è¾‘ (å·²æ›´æ–°)
â””â”€â”€ package.json          # Node.js ä¾èµ–é…ç½®
```

## ğŸš€ ä¸»è¦åŠŸèƒ½é›†æˆ

### 1. ç”¨æˆ·ç®¡ç†
- å¾®ä¿¡ç™»å½•é›†æˆ
- ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ° `users` è¡¨
- æœ¬åœ°ç¼“å­˜ + æ•°æ®åº“åŒæ­¥

### 2. æ™¯ç‚¹æ•°æ®
- çƒ­é—¨æ™¯ç‚¹å±•ç¤º
- ä» `destinations` è¡¨åŠ¨æ€åŠ è½½
- æ”¯æŒåˆ†ç±»å’Œè¯„åˆ†æ’åº

### 3. è¡Œç¨‹ç®¡ç†
- åˆ›å»ºæ–°è¡Œç¨‹å¹¶ä¿å­˜åˆ°æ•°æ®åº“
- ç”¨æˆ·è¡Œç¨‹åˆ—è¡¨å±•ç¤º
- AIç”Ÿæˆè¡Œç¨‹æ”¯æŒ

## ğŸ“Š æ•°æ®è¿ç§»ç»“æœ

### å·²è¿ç§»çš„æ•°æ®
- **æ™¯ç‚¹æ•°æ®**: 8æ¡è®°å½•
  - æ¡‚æ—å±±æ°´ã€å¼ å®¶ç•Œã€ä¸‰äºšæµ·æ»©ç­‰çƒ­é—¨æ™¯ç‚¹
- **è¡Œç¨‹æ•°æ®**: 39æ¡è®°å½•
  - åŒ…å«å„ç§ç±»å‹çš„æ—…è¡Œè®¡åˆ’

### æ•°æ®ç»Ÿè®¡
```sql
-- æ™¯ç‚¹æ€»æ•°
SELECT COUNT(*) FROM destinations; -- 8æ¡

-- è¡Œç¨‹æ€»æ•°  
SELECT COUNT(*) FROM travel_plans; -- 39æ¡

-- æ¨èæ™¯ç‚¹
SELECT COUNT(*) FROM destinations WHERE is_featured = true; -- 8æ¡

-- è®¡åˆ’ä¸­çš„è¡Œç¨‹
SELECT COUNT(*) FROM travel_plans WHERE status = 'planned'; -- 39æ¡
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. æ•°æ®åº“æ“ä½œ
```javascript
// å¼•å…¥æ•°æ®åº“å·¥å…·
const { db } = require('../utils/database')

// è·å–ç”¨æˆ·è¡Œç¨‹
const { data, error } = await db.travelPlans.getByUserId(userId)

// åˆ›å»ºæ–°è¡Œç¨‹
const newPlan = {
  title: 'æ–°æ—…è¡Œè®¡åˆ’',
  destination: 'åŒ—äº¬',
  budget: 3000,
  // ...å…¶ä»–å­—æ®µ
}
const { data, error } = await db.travelPlans.create(newPlan)

// è·å–çƒ­é—¨æ™¯ç‚¹
const { data, error } = await db.destinations.getFeatured(10)
```

### 2. ç¯å¢ƒé…ç½®
ç¡®ä¿ `.env` æ–‡ä»¶åŒ…å«æ­£ç¡®çš„ Supabase é…ç½®ï¼š
```env
VITE_SUPABASE_URL=https://hmnjuntvubqvbpeyqoxw.supabase.co
VITE_SUPABASE_ANON_KEY=your_anon_key_here
```

## ğŸ¯ ä¸‹ä¸€æ­¥ä¼˜åŒ–

1. **æ•°æ®éªŒè¯**: æ·»åŠ è¡¨å•éªŒè¯å’Œæ•°æ®æ ¡éªŒ
2. **é”™è¯¯å¤„ç†**: å®Œå–„æ•°æ®åº“æ“ä½œé”™è¯¯å¤„ç†
3. **ç¼“å­˜ç­–ç•¥**: å®ç°æœ¬åœ°ç¼“å­˜ + æ•°æ®åº“åŒæ­¥
4. **æƒé™æ§åˆ¶**: é…ç½®è¡Œçº§å®‰å…¨ç­–ç•¥ (RLS)
5. **æ€§èƒ½ä¼˜åŒ–**: æ·»åŠ æ•°æ®åˆ†é¡µå’Œç´¢å¼•ä¼˜åŒ–

## ğŸ“ æ³¨æ„äº‹é¡¹

- ç¡®ä¿å°ç¨‹åºæœ‰ç½‘ç»œæƒé™è®¿é—® Supabase API
- å®šæœŸå¤‡ä»½æ•°æ®åº“æ•°æ®
- ç›‘æ§ API è°ƒç”¨é…é¢ä½¿ç”¨æƒ…å†µ
- å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­é…ç½®è¡Œçº§å®‰å…¨ç­–ç•¥

---

**é›†æˆå®Œæˆæ—¶é—´**: 2025-11-18  
**æ•°æ®åº“çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ  
**æ•°æ®è¿ç§»**: âœ… å®Œæˆ